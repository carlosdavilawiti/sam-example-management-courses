const AWS = require('aws-sdk');
AWS.config.update({region: process.env.region});
const dynamodbDoc = new AWS.DynamoDB.DocumentClient();

module.exports.getAll = (tableName) => {
	const params = {
		TableName: tableName,
	};
	return dynamodbDoc.scan(params).promise();
};

module.exports.putItemDynamoDB = (tableName, itemData) => {
	let params = {
		TableName: tableName,
		Item: itemData,
		ScanIndexForward: false
	};
	console.log(`Registrando en la tabla ${tableName} los siguientes elementos ${JSON.stringify(itemData)}`);
	return dynamodbDoc.put(params).promise()
		.then((data) => {
			console.log(`Ã‰xito al insertar en ${tableName}`);
			return data;
		}).catch((e) => {
			console.error("Error al insertar ", e.message);
			return e;
		});
};

module.exports.deleteItemDynamoDB = (tableName, pk) => {
	const params = {
		TableName: tableName, Key: pk
	};
	return dynamodbDoc.delete(params).promise();
};
